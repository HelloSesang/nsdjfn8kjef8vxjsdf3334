<!DOCTYPE html>
<html lang="ko">
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>멜론 티켓</title>

    <!-- 파비콘 -->
    <link rel="shortcut icon" type="image/x-icon" href="https://cdnticket.melon.co.kr/resource/image/web/common/pc_32.ico" />

    <!-- IOS용 -->
    <link rel="apple-touch-icon-precomposed" href="https://cdnticket.melon.co.kr/resource/image/web/common/ios_120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="180x180" href="https://cdnticket.melon.co.kr/resource/image/web/common/ios_180.png" />

    <meta name="viewport" content="width=1126"/><!-- 모바일 접속시 컨텐츠 넓이 -->
    <meta name="keywords" content="티켓, 콘서트, 테마/지역, 랭킹, 티켓오픈소식, 이벤트, FouU, 마이티켓" />
    <meta name="description" content="No.1 음악플랫폼 멜론에서 제공하는 공연 예매사이트. 콘서트, 팬미팅, 페스티벌, 추천공연 제공" />
    <meta property="og:title" content=""/>
    <meta property="og:image" content=""/>
    <meta property="og:description" content="듣다·보다·만나다, 멜론티켓"/>
    <meta property="og:site_name" content="멜론티켓" />
    <meta name="naver-site-verification" content="8912542fdfc7aaf11e289d8bed9e86892deef890"/>
    <script type="text/javascript" src="/resource/script/web/common/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" src="/resource/script/web/common/jquery-migrate-3.3.2.min.js"></script>
    <script type="text/javascript" src="/resource/script/web/common/jquery.inputmask.bundle.js"></script>
    <script type="text/javascript" src="/resource/script/web/common/ui_script.js?v=20181206"></script>
    <script type="text/javascript" src="/resource/script/web/common/melonweb_openlib.js"></script>
    <script type="text/javascript" src="/resource/script/web/common/melonweb_comm.js?t=20220720"></script>
    <script type="text/javascript" src="/resource/script/web/common/melonweb_member_external.js?t=20220720"></script>
    <script type="text/javascript" src="/resource/script/web/common/webUtils.js?v=20220210"></script>
    <script type="text/javascript" src="/resource/script/web/common/CaptchaUtils.js?v=20240116"></script>
    <link rel="stylesheet" type="text/css"
          href="//cdnticket.melon.co.kr/resource/style/web/common/common_onestop-1f4da835a2.css"/>
    <link rel="stylesheet" type="text/css"
          href="//cdnticket.melon.co.kr/resource/style/web/common/onestop-f87677fe72.css"/>
    <script>var APIURL = '/tktapi', POCURL = '/tktapi_poc', CTX = "";</script>
    <!-- 구매전환스크립트2-->
    <!-- Kakao Pixel Code -->
    <script type="text/javascript" charset="UTF-8" src="//t1.daumcdn.net/adfit/static/kp.js"></script>
    <script type="text/javascript">
        kakaoPixel("1432956840521218273").pageView("WEB-공통");
    </script>
    <!-- End Kakao Pixel Code -->
</head>
<body>

<script src="/resource/script/phase/deployPhaseUtils.js"></script>
<!-- 네이버 광고 로그분석 -->
<!-- 공통 적용 스크립트 , 모든 페이지에 노출되도록 설치. 단 전환페이지 설정값보다 항상 하단에 위치해야함 -->
<script type="text/javascript" src="//wcs.naver.net/wcslog.js"> </script>
<script type="text/javascript">
    // console.log("##########################################");
    // console.log("##########################################");
    // console.log("네이버 광고 로그 분석 공통 스크립트 실행");
    // console.log("script_common.jsp");
    // console.log("##########################################");
    // console.log("##########################################");
    if (!wcs_add) var wcs_add={};
    wcs_add["wa"] = "s_585b06516861";
    if (!_nasa) var _nasa={};
    if(window.wcs){
        wcs.inflow("melon.com");
        wcs_do(_nasa);
    }
</script>
<!-- END 네이버 광고 로그분석 -->
<link rel="stylesheet" type="text/css" href="//cdnticket.melon.co.kr/resource/style/web/common/onestop_map-9b67a82c75.css" />
<script src="/resource/script/web/common/iscroll-zoom-custom.js"></script>
<script src="/resource/script/web/common/iscroll5-ie8.js"></script>
<script src="/resource/script/seat/raphael_custom.js?t=201904161200"></script>
<script src="/resource/script/seat/EzZMSeatCus.js?t=202411051200"></script>
<script src="/resource/script/seat/EzCusObject.js"></script>
<script src="/resource/script/seat/EzSeatCusIdx.js"></script>
<script type="text/javascript">

    var brCheck = false;
    var myScroll;
    var zoomFactor = 1.2;

    function loaded() {

        myScroll = new IScroll('#wrapper', {
              zoom: true,
              zoomMax:10,
              probType:1,
              HWCompositing:false,
              tab:true,
              freeScroll: true,
              scrollX: true,
              scrollY: true,
              mouseWheel: true,
              scrollbars: true,
              bounce: false,
              interactiveScrollbars: true,
              fadeScrollbars: false,
              indicators: {
                  el: '#minimap',
                  shrink: 'scale',
                  interactive: true
              },
              wheelAction: 'zoom'
        });
    }
    $('#wrapper').on("touchmove", function (ev) {
          var e = ev.originalEvent;
          if (e.preventDefault) {
              e.preventDefault();
          } else {
              e.returnValue = false;
          }
      });
</script>
<!--[if IE 8]>
<script src="/resource/script/seat/raphael-custom.js?t=201904161200"></script>
<script type="text/javascript">
    brCheck = true;
    $(function(){
        $('#wrapper').bind('mousedown', function(e){
            e.preventDefault();
            $(this).data({'drag':1, 'x':e.pageX, 'y':e.pageY});
            $(this).css({'cursor':'move'});
        }).bind('mousemove', function(e) {
            var sc = $('#scroller');
            if ($(this).data('drag') == 1) {
                dX = e.pageX - $(this).data('x');
                dY = e.pageY - $(this).data('y');
                dT = parseFloat(sc.css('top'))+dY;
                dL = parseFloat(sc.css('left'))+dX;
                sc.css({'top':dT, 'left':dL});
                $(this).data({'x':e.pageX, 'y':e.pageY});
            };
        }).bind('drag', function(e) {
            e.preventDefault();
        }).bind('mouseup', function(e){
            $(this).removeData('drag');
            $(this).css({'cursor':'auto'});
        });
    });
</script>
<![endif]-->
<div class="section_onestop" id="section_onestop">
    <!--좌석선택  영역-->
    <div class="wrap_select">
        <div class="box_seat_top">
            <h3 class="tit_seat">좌석 선택<span class="tit_s txt_prod_name"></span>
                <span class="seat_wrap_sel">
                    <!-- 셀렉트박스 -->
                    <select id="scheduleNo" name="scheduleNo" class="sel_cate" onChange="selectSchedule(this);" onfocus="setOriginNo(this);">
                    </select>
                </span>
            </h3>
        </div>
        <!-- 좌석영역-->
        <div class="wrap_seat">
            <div class="btn_extension"><a href="#" class="btn_plus" id="btn_map_p">확대</a><a href="#" class="btn_minus" id="btn_map_m">축소</a></div>
            <div id="wrapper">
                <div id="scroller">
                    <div id="ez_canvas" style="width:100%"></div>
                </div>
            </div>
            <div class="wrap_seat_box">
                <div class="seat_box "><!-- on class 컨트롤 -->
                    <div class="seat_btn" id="txtSelectSeatInfo" onclick="$(this).parent().toggleClass('open');return false;">좌석을 선택해 주세요</div>
                    <div class="seat_choice">
                        <ul id="partSeatSelected" class="seat_info">
                        </ul>
                    </div><!-- //seat_choice끝 -->
                </div>
            </div>
        </div>
        <!--// 좌석영역-->
    </div>
    <!--// 좌석선택  영역-->
    <!--티켓 정보 영역-->
    <div class="wrap_ticket_info">
        <h2 class="logo_onestop"><a href="#none"><img src="https://cdnticket.melon.co.kr/resource/image/web/onestop/logo_onestop.png" alt="Melon 티켓"></a></h2>
        <div class="box_info box_map">
            <div class="minimap_scroller" id="minimap_scroller">
                <div class="map_seat">
                    <div   id="iez_canvas"></div>
                </div>
            </div>
            <div>
                <div id="minimap">
                    <div id="minimap-indicator"></div>
                </div>
            </div>
        </div>
        <div class="wrap_seat_list ">
            <!-- 기본 좌석등급/잔여석-->
            <div class="seat_list">
                <h3 class="select_tit">좌석등급/잔여석<span class="ico_info" onmouseover="toolTip('layer_ticket');">유의사항</span><a href="#none" id="btnReloadSchedule" class="btn_flexible btn_flexible_ico2 btn_detail"><span>새로고침</span></a></h3>
                <div class="box_seat">
                    <div class="box_seat_inner box_seat_area">
                        <table class="tbl">
                            <caption class="hide"></caption>
                            <colgroup>
                                <col style="width:26px;" />
                                <col />
                                <col style="width:65px;" />
                                <col style="width:60px;" />
                            </colgroup>
                            <tbody id="partSeatGrade">
                            </tbody>
                        </table>
                    </div>
                </div>
                <!--유의사항 레이어팝업-->
                <div class="layer_ticket" id="layer_ticket" style="position:absolute;top:15px;left:0;width:238px;">
                    <div class="layer_arr" style="left:114px;"></div>
                    <div class="tk_header">
                        <div class="tk_header1">
                            <span class="tk_tit"></span>
                        </div>
                    </div>
                    <div class="tk_middle">
                        <div class="tk_middle1">
                            <div>
                                <p>좌석선택 이후 5분이내 결제가 완료되지 않을 시 선택하신 좌석의 선점 기회를 잃게 됩니다.</p>
                            </div>
                        </div>
                    </div>
                    <div class="tk_footer"><div class="tk_footer1"></div></div>
                </div>
                <!--// 유의사항 레이어팝업-->
            </div>
            <!--//기본 좌석등급/잔여석-->
        </div>
        <div class="box_info_bm">
            <div class="btn_onestop">
                <span class="button btNext"><a href="#" id="nextTicketSelection" class="btnOne btnOneB">좌석 선택 완료<em class="one_arr next_ar">다음</em></a></span>
            </div>
        </div>
        <!--// 티켓 정보 영역 -->
    </div>
</div>
<!-- ZAM-netfunnel -->
<script type="text/javascript" src="/resource/script/web/common/netfunnel.js"></script>

<script type="text/javascript">
    function goTicketType() {
        var rtchk = true;
        if (parent.data.selectedSeatCount <= 0) {
            alert("선택된 좌석이 없습니다.");
            rtchk = false;
        }else {
            var params		= parent.$("#sForm").serializeArray();
            var chkSeatCount	= 0;

            $.each(parent.seatData, function(key, val){
                params.push({name: "seatId"              , value: val.sid});
                params.push({name: "clipSeatId"          , value: val.csid});
                chkSeatCount++;
            });
            params.push({ name : "chkcapt"    , value : Captcha.getData()});

            $.ajax({
                type                : "POST"
                , dataType          : "jsonp"
                , url               : APIURL + "/reservation/prodlimit.json?v=1"
                , async             : false
                , data              : params
                , success           : function(result) {
                    if(result.result == "0000") {
                        var cnt = 0;
                        $.each(parent.seatData, function (key, val) {
                            parent.$("#sFormSub").append('<input type="hidden" id="seatIds' + cnt + '" name="seatIds" value="' + val.sid + '">');
                            cnt++
                        });

                        var sf = parent.document.sForm;
                        var sfs = parent.document.sFormSub;

                        //encrpytedSeatIds, inter
                        sfs.encryptedSeatIds.value = result.encryptedSeatIds;
                        sfs.interlockTid.value = result.interlockTid;

                        sfs.scheduleNo.value = sf.scheduleNo.value;
                        sfs.flplanTypeCode.value = sf.flplanTypeCode.value;
                        sfs.seatTypeCode.value = sf.seatTypeCode.value;
                        sfs.target = "oneStopFrame";
                        sfs.action = CTX + "/reservation/popup/stepTicket.htm";
                        sfs.submit();

                        for (var i = 0; i < cnt; i++) {
                            parent.$("#seatIds" + i).remove();
                        }
                    } else {
                        if (result.code != 'T0002')         // 인증예매(캡챠) 미완료시  alert 없이 팝업만 표출하기 위함
                            console.warn(result.message);

                        if (result.code == "T8270" || result.code == "T8280") {
                            init();
                        } else if (result.code == "T9110") {
                            parent.rsrvPopupClose();
                        } else if (result.code == 'T0002') {                // T0002 : 인증 미완료시
                            parent.captchaObj.show();
                            Captcha.setData('');
                        }
                    }
                }
                , error             : function(e) {
                    alert("다시 시도부탁드립니다.");
                }
            });
        }
    }

    function getSeatList() {
        var params                  = parent.$("#sForm").serialize();
        parent.data.seatdata        = {};
        parent.seatData             = {};
        var prodId		= parent.$("#prodId").val();
        var scheduleNo	= parent.$("#scheduleNo").val();
        var blockId		= parent.$("#blockId").val();
        var url = parent.isLottery ? "/product/seat/seatMapListLottery.json?v=1" :"/product/seat/seatMapList.json?v=1";
        $.ajax({
            type            : "POST"
            , dataType      : "jsonp"
            , cache         : true
            , url           : APIURL + url
            , async         : false
            , data          : {
                                  prodId: prodId
                                , scheduleNo: scheduleNo
                                , blockId: blockId
                                , pocCode: parentData.pocCode
                                , corpCodeNo: getCookie('corpCodeNo')
                              }
            , jsonpCallback: "getSeatListCallBack"
            , success       : function(result) {
            	if(result.code=="T9110"){
            		alert(result.message);
            		parent.self.close();
            	}

            	if(result.code=="T9217"){
            		alert(result.message);
            	}

                seatData            = result.seatData;

                if(seatData != undefined ){
                    var bBlock = false;
                    var hh = $(window).height() - $('#header').height() - $('#fixed_bottom').height() + $('.seat_btn').height();
                    if(seatData.mt == 'BLOCK'){
                        bBlock = true;
                        $('#minimap-indicator').css('visibility', 'hidden');
                        $(".area").html(parent.$("#areaNo").val())
                        $(".box_fix_info").show();
                        $('.wrap_seat').addClass('type4');
                        $("#header").css('z-index', '1');
                        hh = $(window).height() - $('#header').height() - $('#fixed_bottom').height() + $('.seat_btn').height() - $(".box_fix_info").height();
                        $('.box_fix_info').css('z-index', '1');
                        $('.map').css('z-index', '2');

                    }else{
                        $('#minimap-indicator').css('visibility', 'visible');
                        $(".box_fix_info").hide();
                        $('.wrap_seat').removeClass('type4');
                    }
                    $('#ez_canvas').css('width', $('.wrap_seat').width()+'px');
                    $('#scroller').css('width', $('.wrap_seat').width()+'px');
                    $('#wrapper').css('width', $('.wrap_seat').width()+'px');
                    $('#ez_canvas').css('height', ($('.wrap_seat').height())+'px');
                    $('#scroller').css('height', ($('.wrap_seat').height())+'px');
                    $('#wrapper').css('height', ($('.wrap_seat').height())+'px');

                    fnLoadSeatMap(seatData, parent.lmt, bBlock);

                    $("#partSeatSelected").empty();
                    parent.data.selectedSeatCount = "0";
                    setSelectSeatCount();

                }
            }
            , error         : function(e) {
            		setLoading(false);
            		alert("다시 시도부탁드립니다.");
        			location.reload(true);
            }
       });
    }

    function removeAllSelectedSeat(){

        selectedCount = 0;
        parent.data.selectedSeatCount = selectedCount;
        setSelectSeatCount();

        for( var i in parent.seatData){
            var objectid     = "selectedSeat" + i;
            $("#" + objectid).remove();
            delete parent.seatData[i];

        }
    }

    function setProdSeat() {
        $(".txt_prod_seat").empty();
        $.each(parent.seatData, function(key, val) {
            $(".txt_prod_seat").append(val.title + "<br>");
        });
    }

    SeatInfo = function(id, grade, tit, st, csid, gn)
    {
        this.sid			= id;
        this.grade		= grade;
        this.title		= tit;
        this.seatType	= st;
        this.csid 		= csid;
        this.gn			= gn;
    }

    function selectSeat(sid, pSeatGrade, pSeatTitle, selectCount, pSeatTypeCode, pClipSeatId, pSeatGradeNm) {
        var objectid     = "selectedSeat" + sid;
        if ($("#"+objectid).get() == null || $("#"+objectid).get() == "") {
            $("<li id=\"" + objectid + "\">").html(pSeatTitle +"<input type='hidden' name='seat_id' value='"+sid+"'/>").appendTo($("#partSeatSelected"));
            parent.seatData[sid] = new SeatInfo(sid, pSeatGrade, pSeatTitle, pSeatTypeCode, pClipSeatId, pSeatGradeNm);
            parent.$("#seatTypeCode").val(pSeatTypeCode);
        }
        parent.data.selectedSeatCount = selectCount;
        setSelectSeatCount();
    }
    function unselectSeat(sid, selectCount){
        var objectid     = "selectedSeat" + sid;
        $("#" + objectid).remove();
        delete parent.seatData[sid];
        parent.data.selectedSeatCount = selectCount;
        setSelectSeatCount();
    }

    function selectNASeat(sid, pSeatGrade, pSeatTitle, selectCount, pSeatTypeCode){
        removeAllSelectedSeat();
        var objectid     = "selectedSeat" + sid;
        $("<li id=\"" + objectid + "\">").html("<input type='hidden' name='seat_id' value='"+sid+"'/>").appendTo($("#div_seat_selected"));
        parent.seatData[sid]        = new SeatInfo(sid, pSeatGrade, pSeatTitle, pSeatTypeCode);
        parent.$("#seatTypeCode").val(pSeatTypeCode);
        parent.data.selectedSeatCount = 1;
        goTicketType();
    }

    function setSelectSeatCount() {
        var selectCount         = parent.data.selectedSeatCount;
        if (selectCount > 0) {
            $("#txtSelectSeatInfo").html("선택한 좌석 총 <span class=\"txt_seat\">" + selectCount + "석</span>이 선택되었습니다.");
            $("#nextTicketSelection").parent().addClass("on");
        }
        else {
            $("#txtSelectSeatInfo").html("좌석을 선택해 주세요.");
            $("#nextTicketSelection").parent().removeClass("on");
        }
    }

    function searchSummaryList() {
        var params = parent.$("#sForm").serialize();
        var perfDate = parent.$("#perfDate").val();
        var url = parent.isLottery ? "/product/summaryLottery.json?v=1" :"/product/summary.json?v=1";

        $.ajax({
            type            : "POST"
            , dataType      : "jsonp"
            , cache         : true
            , url           : APIURL + url
            , async         : false
            , data          : {
                                prodId: parentData.prodId
                              , pocCode: parentData.pocCode
                              , scheduleNo: parent.$("#scheduleNo").val()
                              , perfDate: perfDate
                              , corpCodeNo:getCookie('corpCodeNo')
                              }
            , jsonpCallback : "getBlockGradeSeatCountCallBack"
            , success       : function(result) {
                bindSummaryList(result.summary);
            }
            , error         : function(e) {
            		setLoading(false);
            		alert("다시 시도부탁드립니다.");
            		location.reload(true);
            }
        });
    }

    function bindSummaryList(list) {
        $("#partSeatGrade").html("");
        $.each(list, function(key, val) {
            $("<tr/>")
            .append("<th class=\"seat_color\"><em class=\"seat_color seat_vip\" style=\"background-color:" + val.gradeColorVal + "\"></em></th>")
            .append("<td class=\"seat_name\">" + val.seatGradeName + "</td>")
            .append("<td class=\"price\">" + addComma(val.basePrice) + "원</td>")
            .append(parent.prodData.seatCntDisplayYn == "Y" ? "<td class=\"seat_remain\">" + addComma(val.realSeatCntlk) + "석</td>" : "<td class=\"seat_remain\"></td>")
            .appendTo($("#partSeatGrade"));
            parent.gradeData[val.seatGradeNo]      = val.seatGradeName;
        });
        setLoading(false);
    }

    function bindScheduleList() {
        var scheduleList        = $("#scheduleNo");
        var scheduleNo          = parent.$("#scheduleNo").val();
        var schtitle            = "";
        var schDate             = "";
        var schTime             = "";

        scheduleList.empty();
        $.each(parent.schData, function(key, val) {
            schtitle                = "";
            schDate                 = val.perfStartDay;
            schTime                 = val.perfStartTime;

            schtitle                = schDate.substr(0,4) + "." + schDate.substr(4,2) + "." + schDate.substr(6,2) + " (" + getWeekDay(schDate, "", "1") + ") ";
            schtitle                += schTime.substr(0,2) + ":" + schTime.substr(2,2);

         	// ## 20181207 Ultra ##  (new add)
            schtitle = parent.checkDateUnsettled(schDate, schTime, schtitle);

            var schoption           = $("<option />").val(val.scheduleNo).text(schtitle);
            if (scheduleNo == val.scheduleNo) {
                schoption.attr({selected: "selected"});
            }

            scheduleList.append(schoption);
        });
    }

    /**
     * 초기 값을 저장.
     */
    var setOriginNo = function(_this){
        _this.originValue = _this.value;
    };
    /**
     * 선택한 스케쥴을 인증함.
     */
    var selectSchedule = function(_this) {
        var scheduleNo = _this.value;
        var sellTypeCode        = "";
        var orderNo             = "";
        parent.gradeData = {};

        $.each(parent.schData, function(key, val) {
            if (scheduleNo == val.scheduleNo) {
                sellTypeCode        = val.sellTypeCode;
                orderNo             = val.orderNo;
            }
        });

        if(sellTypeCode === 'ST0001'){
            selectedSchedule(scheduleNo, sellTypeCode, orderNo);
        }else{
			var _self = this;

			_self.resolveFailedValidation = function(){
				var checkMsg = '선예매';
				if(sellTypeCode === 'ST0002'){

				}else if(sellTypeCode === 'ST0003'){
					checkMsg = '추첨예매';
				}

				alert(checkMsg+" 인증 정보를 확인 할 수 없습니다.");

				_this.value = _this.originValue;
			};

			_self.resolve = function(result){
				if(result.data.authYn === 'Y'){
					selectedSchedule(scheduleNo, sellTypeCode, orderNo);
				}else{
					_self.resolveFailedValidation();
				}
			};

			_self.reject = function(e){
				_self.resolveFailedValidation();
			};

			checkAuth(sellTypeCode, orderNo, _self.resolve, _self.reject);
		}
    };

    var checkAuth = function(sellTypeCode, sc, resolve, reject) {
        var trgt = '';
        if(sellTypeCode === 'ST0002'){
            trgt = 'prersrv';
        }else if(sellTypeCode === 'ST0003'){
            trgt = 'pickrsrv';
        }
        $.ajax({
            type            : "POST"
            , dataType      : "jsonp"
            , url           : APIURL + "/"+ trgt +"/usercond.json?v=1"
            , async         : false
            , data          : {
                                prodId: parentData.prodId
                              , pocCode: parentData.pocCode
                              , sellTypeCode: sellTypeCode
                              , sellCondNo: sc
                              }
            , jsonpCallback: "chekUserCond"
            , success         : function(result) {
                resolve(result);
            }
            , error           : function(e) {
                reject(e);
            }
       });
    };

    function selectedSchedule(scheduleNo, sellTypeCode, orderNo) {
		parent.$("#sellTypeCode").val(sellTypeCode);
		parent.$("#scheduleNo").val(scheduleNo);
		parent.$("#sellCondNo").val(orderNo);
        parent.$("#blockId").val("");
		parent.reset();
    }

    function init() {
        setLoading(true);
        valiProductSchedule();

        getSeatList();

        bindScheduleList();

        searchSummaryList();

        parent.setProdSchedule();

        parent.data.selectedSeatCount = 0;

        myScroll.zoom(0);

        if (parent.$("#trafficCtrlYn").val() == "Y") {
            //Netfunnel 명시적 완료처리
            NetFunnel_aliveNotice(
                {
                    ipblock: function(ev, ret) {
                        return false;
                    },
                    block: function(ev,ret) {
                        alert(ret.data.msg);
                        return false;
                    }
                }
            );
        }
    }

    function valiProductSchedule(){
        if (parent.$("#scheduleNo").val() != "") {
            $.ajax({
                type            : "POST"
                , dataType      : "jsonp"
                , cache         : true
                , url           : POCURL + "/performance/getProdSellState.json?v=1"
                , async         : false
                , data          : {
                                    prodId: parentData.prodId
                                  , scheduleNo: parent.$("#scheduleNo").val()
                                  }
                , jsonpCallback : "getValiProductScheduleCallBack"
                , success         : function(result) {
                    if(result.result != 0){
                        alert("판매가능 상태가 아닙니다.");
                        parent.window.open("about:blank", "_self").close();
                    }
                }
                , error           : function(e) {
                    setLoading(false);
                }
           });
        }else{
        		setLoading(false);
        }
    }

    var parentData = {};
    $('#section_onestop').ready(function() {
        parentData.prodId = parent.$("#prodId").val();
        parentData.pocCode = parent.$("#pocCode").val();
        loaded();
        init();
        InitBody();

        $("#btnChangeBlocK").click(function(event) {
            event.preventDefault();
            popupBlock();
        });

        $("#nextTicketSelection").click(function(event) {
            event.preventDefault();
            if (parent.data.selectedSeatCount > 0) goTicketType();
        });

        $("#btnReloadSchedule").click(function(event) {
            event.preventDefault();
            init();
        });

        $('#btn_map_m').click(function(event) {
            event.preventDefault();
            myScroll.zoom(myScroll.scale - zoomFactor);

        });
        $('#btn_map_p').click(function(event) {
            event.preventDefault();
            myScroll.zoom(myScroll.scale + zoomFactor);
        });
    });

    function popupBlock() {
        var params = parent.$("#sForm").serialize();
        $.ajax({
            type           : "POST"
            , url          : CTX + "/product/include/block.htm"
            , async        : false
            , data         : params
            , success      : function(result) {
                $("#popup_block_selection").html(result);
                $("#popup_block_selection").show();
            }
            , error        : function(e) {
                alert("잠시 서비스가 지연되고 있습니다.");
                $("#popup_block_selection").hide();
            }
        });
    }

    function setLoading (isloading) {
        paysync         = isloading;
        if (isloading) {
	        	loadingOpen(" ");
        }
        else {
            setTimeout(function(){
            		loadingClose();
            }, 500);
        }
    }

</script>
</body>
</html>
